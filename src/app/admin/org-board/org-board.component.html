<div class="change-password-card">
  <mat-card class="mat-elevation-z0 change-password-body">

    <mat-card-title class="change-password-title">Change Password</mat-card-title>

    <form #changePasswordForm="ngForm">
      <mat-form-field
        appearance="outline"
        class="change-password-form-field"
      >
        <input
          matInput
          class="change-password-form-input"
          [type]="hideCurrentPassword ? 'password' : 'text'"
          ngModel
          name="currentPassword"
          required
          #currentPassword="ngModel"
          placeholder="Current Password"
        />

        <button
          mat-icon-button
          matSuffix
          (click)="hideCurrentPassword = !hideCurrentPassword"
          [attr.aria-label]="'Hide password'"
          [attr.aria-pressed]="hideCurrentPassword"
        >
          <mat-icon>{{
            hideCurrentPassword ? "visibility_off" : "visibility"
          }}</mat-icon>
        </button>

        <mat-error *ngIf="currentPassword.invalid"
          >Please enter your current password.</mat-error
        >
      </mat-form-field>

      <mat-form-field
        appearance="outline"
        class="change-password-form-field"
      >
        <input
          matInput
          class="change-password-form-input"
          [type]="hideNewPassword ? 'password' : 'text'"
          ngModel
          name="newPassword"
          required
          #newPassword="ngModel"
          placeholder="New Password"
        />

        <button
          mat-icon-button
          matSuffix
          (click)="hideNewPassword = !hideNewPassword"
          [attr.aria-label]="'Hide password'"
          [attr.aria-pressed]="hideNewPassword"
        >
          <mat-icon>{{
            hideNewPassword ? "visibility_off" : "visibility"
          }}</mat-icon>
        </button>

        <mat-error *ngIf="newPassword.invalid"
          >Please provide us with your new password.</mat-error
        >
      </mat-form-field>

      <mat-card-footer class="change-password-footer">
        <button
          class="btn btn-outline-primary mb-2 mr-2 change-password-button"
          (click)="onChangePassword(changePasswordForm)"
        >
          Request password change
        </button>
      </mat-card-footer>
    </form>
  </mat-card>
</div>

<div
  *ngIf="requestedNewPassword"
  class="alert alert-success alert-dismissible fade show"
  role="alert"
>
  <strong>Password changed!</strong>
  <button
    (click)="closeNotification()"
    type="button"
    class="close"
    data-dismiss="alert"
    aria-label="Close"
  >
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<div>
  <p
    class="info-text mat-body-1"
    *ngIf="hasRequest"
  >
    <b>Posts that has not been approved by CCSGP Admins yet D:</b>
  </p>

  <div
  fxLayout="row wrap"
  fxLayout.xs="column"
  fxLayoutWrap
  fxLayoutGap="1.0%"
  fxLayoutAlign="center"
  fxFlexAlign="auto"
  >
    <div class="centered" *ngFor="let post of posts">
      <section class="cards" *ngIf="!post.approved">
        <mat-card
        class="request-post-card"
        *ngIf="!post.approved">
          <mat-card-title class="post-card-title">{{ post.title }}</mat-card-title>
          <mat-card-subtitle class="post-card-subtitle"
            >{{ post.startDate | date }} to
            {{ post.endDate | date }}</mat-card-subtitle
          >
          <mat-card-content class="post-card-content">{{ post.content }}</mat-card-content>
          <mat-footer class="post-card-footer">
            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onMoreInfo(content)"
            >
              Learn More
            </button>

            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onDeletePrompt(deleteReportedContent)"
            >
              Delete
            </button>
          </mat-footer>
        </mat-card>

        <!--
        <p-card
          class="card"
          styleClass="p-card-shadow"
          *ngIf="!post.approved"
        >
          <p-card-header
            [style]="{
              'text-overflow': 'ellipsis',
              width: '22rem',
              'max-width': '22rem',
              height: '1.7rem',
              display: 'block',
              overflow: 'hidden',
              'white-space': 'nowrap',
              color: 'white',
              'font-size': '1.5rem'
            }"
          >
            <b>{{ post.title }}</b>
          </p-card-header>

          <p-card-subheader
            [style]="{
              height: '3.5rem',
              display: 'block',
              overflow: 'hidden',
              'white-space': 'nowrap',
              color: '#D9D9D9'
            }"
          >
            {{ post.startDate | date }} to {{ post.endDate | date }}
          </p-card-subheader>

          <p-card-content
            [style]="{
              'text-overflow': 'ellipsis',
              width: '22rem',
              'max-width': '22rem',
              height: '3rem',
              display: 'block',
              overflow: 'hidden',
              'white-space': 'nowrap',
              color: '#D9D9D9'
            }"
            >{{ post.content }}
          </p-card-content>


          <ng-template pTemplate="footer" #footer>
            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onMoreInfo(content)"
            >
              Learn More
            </button>

            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onDeletePrompt(deleteUnapprovedContent)"
            >
              Delete
            </button>
          </ng-template>
        </p-card>
        -->

      </section>

      <ng-template #content let-modal>
        <div class="modal-header">
          <h4 class="modal-title">{{ post.title }}</h4>
          <button
            type="button"
            class="close"
            aria-label="Close"
            (click)="modal.dismiss('Cross click')"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <p>Organization Name: {{ post.orgName }}</p>
          <p>UEN: {{ post.uen }}</p>
          <p>Student Group Name: {{ post.studentGroupName }}</p>
          <p>Point of Contact (POC): {{ post.POC }}</p>
          <p>POC's phoneNumber: {{ post.phoneNumber }}</p>
          <p>POC's email: {{ post.email }}</p>
          <p>Brief Description for gig: {{ post.content }}</p>
          <p>Preferred Skills: {{ post.skills }}</p>
          <p>Start Date: {{ post.startDate | date }}</p>
          <p>End Date: {{ post.endDate | date }}</p>
          <p>Commitment Hours: {{ post.hoursRequired }}</p>
          <p>Beneficiaries: {{ post.beneficiaries }}</p>
        </div>

        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-light"
            (click)="modal.close('Close click')"
          >
            Close
          </button>
        </div>
      </ng-template>



      <ng-template #deleteUnapprovedContent let-modal>
        <div
          class="modal-header"
        >
          <h4 class="modal-title">Delete Confirmation</h4>
          <button
            type="button"
            class="submit"
            aria-label="apply"
            (click)="modal.dismiss('Cross click')"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div
          class="modal-body"
        >
        <p>Are you sure you want to delete the post?</p>
        </div>

        <div
          class="modal-footer"
        >

        <button
            type="button"
            class="btn btn-light"
            (click)="
            onDelete(post.id) && modal.dismiss('Cross click')
            "
          >
            Confirm Delete
          </button>

          <button
            type="button"
            class="btn btn-light"
            (click)="modal.dismiss('Cross click')"
          >
            Cancel
          </button>
        </div>
      </ng-template>





    </div>
  </div>

  <p
    class="info-text mat-body-1"
    *ngIf="!hasRequest">
    No post requests or all posts have already been approved! :D
  </p>
</div>

<div>
  <p class="info-text mat-body-1">
    <b>Posts with applications! :D</b>
  </p>

  <div
    fxLayout="row wrap"
    fxLayout.xs="column"
    fxLayoutWrap
    fxLayoutGap="5.0%"
    fxLayoutAlign="center"
  >
    <div class="centered" *ngFor="let post of posts">
      <section class="cards" *ngIf="post.students.length > 0">

        <mat-card
        class="application-post-card">
          <mat-card-title class="post-card-title">{{ post.title }}</mat-card-title>
          <mat-card-subtitle class="post-card-subtitle"
            >{{ post.startDate | date }} to
            {{ post.endDate | date }}</mat-card-subtitle
          >
          <mat-card-content class="post-card-content">{{ post.content }}</mat-card-content>
          <mat-footer class="post-card-footer">
            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onMoreInfo(applicantContent)"
            >
              View Applicants
            </button>
            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onMoreInfo(content)"
            >
              Learn More
            </button>

            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onDeletePrompt(deleteReportedContent)"
            >
              Delete
            </button>
          </mat-footer>
        </mat-card>

        <!--
        <p-card
          class="card"
          [style]="{
            width: '25rem',
            height: '15rem',
            'text-align': 'center',
            'background-color': '#122e2b',
            color: 'white'
          }"
          styleClass="p-card-shadow"
        >
          <p-card-header
            [style]="{
              'text-overflow': 'ellipsis',
              width: '22rem',
              'max-width': '22rem',
              height: '1.7rem',
              display: 'block',
              overflow: 'hidden',
              'white-space': 'nowrap',
              color: 'white',
              'font-size': '1.5rem'
            }"
          >
            <b>{{ post.title }}</b>
          </p-card-header>

          <p-card-subheader
            [style]="{
              height: '3.5rem',
              display: 'block',
              overflow: 'hidden',
              'white-space': 'nowrap',
              color: '#D9D9D9'
            }"
          >
            {{ post.startDate | date }} to {{ post.endDate | date }}
          </p-card-subheader>

          <p-card-content
            [style]="{
              'text-overflow': 'ellipsis',
              width: '22rem',
              'max-width': '22rem',
              height: '3rem',
              display: 'block',
              overflow: 'hidden',
              'white-space': 'nowrap',
              color: '#D9D9D9'
            }"
            >{{ post.content }}
          </p-card-content>

          <ng-template pTemplate="footer" #footer>
            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onMoreInfo(applicantContent)"
            >
              View Applicants
            </button>

            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onMoreInfo(content)"
            >
              Learn More
            </button>

            <button
              class="btn btn-outline-primary mb-2 mr-2"
              (click)="onDeletePrompt(deleteAppliedContent)"
            >
              Delete
            </button>
          </ng-template>
        </p-card>
      -->



      </section>

      <ng-template #applicantContent let-modal>
        <div class="modal-header">
          <h4 class="modal-title">{{ post.title }}</h4>
          <button
            type="button"
            class="close"
            aria-label="Close"
            (click)="modal.dismiss('Cross click')"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <div *ngFor="let student of post.students">
            <div style="border: thin solid black; margin-top: 0.5rem; margin-bottom: 0.5rem;">
              <p style="text-align: center">
                Student's Email: {{ student.email }}
              </p>
              <p style="text-align: center">
                Student's Contact: {{ student.contact }}
              </p>
              <p style="text-align: center">
                Student's Application: {{ student.content }}
              </p>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-light"
            (click)="modal.close('Close click')"
          >
            Close
          </button>
        </div>
      </ng-template>

      <ng-template #content let-modal>
        <div class="modal-header">
          <h4 class="modal-title">{{ post.title }}</h4>
          <button
            type="button"
            class="close"
            aria-label="Close"
            (click)="modal.dismiss('Cross click')"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <p>Organization Name: {{ post.orgName }}</p>
          <p>UEN: {{ post.uen }}</p>
          <p>Point of Contact (POC): {{ post.POC }}</p>
          <p>POC's phoneNumber: {{ post.phoneNumber }}</p>
          <p>POC's email: {{ post.email }}</p>
          <p>Brief Description for gig: {{ post.content }}</p>
          <p>Preferred Skills: {{ post.skills }}</p>
          <p>Start Date: {{ post.startDate | date }}</p>
          <p>End Date: {{ post.endDate | date }}</p>
          <p>Commitment Hours: {{ post.hoursRequired }}</p>
          <p>Beneficiaries: {{ post.beneficiaries }}</p>
        </div>

        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-light"
            (click)="modal.close('Close click')"
          >
            Close
          </button>
        </div>
      </ng-template>


      <ng-template #deleteAppliedContent let-modal>
        <div
          class="modal-header"
        >
          <h4 class="modal-title">Delete Confirmation</h4>
          <button
            type="button"
            class="submit"
            aria-label="apply"
            (click)="modal.dismiss('Cross click')"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div
          class="modal-body"
        >
        <p>Are you sure you want to delete the post?</p>
        </div>

        <div
          class="modal-footer"
        >

        <button
            type="button"
            class="btn btn-light"
            (click)="
            onDeleteAppliedPost(post.id) && modal.dismiss('Cross click')
            "
          >
            Confirm Delete
          </button>

          <button
            type="button"
            class="btn btn-light"
            (click)="modal.dismiss('Cross click')"
          >
            Cancel
          </button>
        </div>
      </ng-template>







    </div>
  </div>

  <p
    class="info-text mat-body-1"
    *ngIf="!hasApplication"
  >
    No applications or no post approved :/
  </p>
</div>
