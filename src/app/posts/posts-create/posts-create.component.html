<div class="post-create-container">

  <mat-spinner *ngIf="isLoading"></mat-spinner>


  <mat-card class="post-create-body">
    <mat-horizontal-stepper linear="Enable linear mode" #stepper class="post-create-stepper"
      (selectionChange)="generatePreview()">
      <mat-step [stepControl]="POCInformationGroup">
        <form [formGroup]="POCInformationGroup">
          <ng-template matStepLabel>
            Point Of Contact (POC)
          </ng-template>

          <mat-form-field appearance="outline">
            <mat-label>Organisation's Name</mat-label>
            <input matInput class="form-input" type="text" name="orgName" required [formControl]="orgNameControl"
              placeholder="eg Standard Oil Co." />
            <mat-error *ngIf="orgNameControl.errors?.required">Please enter provide us the name of the Organisation you
              are helping to create the post for.</mat-error>
          </mat-form-field>

          <div class="show-uen-checkbox-container">
            <mat-checkbox class="show-uen-checkbox"[formControl]="showUenControl">We are an organisation with a UEN</mat-checkbox>
          </div>

          <mat-form-field appearance="outline" *ngIf="POCInformationGroup.value.showUen">
            <mat-label>POC's UEN</mat-label>
            <input matInput class="form-input" type="text" name="uen" [formControl]="uenControl"/>
            <mat-error *ngIf="uenControl.errors?.invalid">Please enter provide us the name of your Point-Of-Contact.
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>POC's Email Address</mat-label>
            <input matInput class="form-input" type="email" name="email" required [formControl]="emailControl"
              placeholder="eg jeff@amazon.com" email />
            <mat-error *ngIf="emailControl.errors?.invalid">Please provide us your email.</mat-error>
          </mat-form-field>

          <a *ngIf="authStatusObject.admin" href="https://verify-email.org/" target="_blank" style="margin-top: 0rem;">Check if email exists (might not
            be accurate)</a>

          <mat-form-field appearance="outline">
            <mat-label>POC's Name</mat-label>
            <input matInput class="form-input" type="text" name="POC" required [formControl]="pocControl"
              placeholder="eg Jeff Bezos" />
            <mat-error *ngIf="pocControl.errors?.invalid">Please enter provide us the name of your Point-Of-Contact.
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>POC's Contact Number</mat-label>
            <input matInput class="form-input" type="number" name="phoneNumber" required
              [formControl]="phoneNumberControl" placeholder="eg 98761234"
              oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
              maxlength="8" />
            <mat-error *ngIf="phoneNumberControl.errors?.invalid">Please provide us your Point-Of-Contact's phone
              number.</mat-error>
          </mat-form-field>
        </form>

        <div class="step-footer">
          <button mat-raised-button color="primary" matStepperNext class="nav-button">Next</button>
        </div>
      </mat-step>

      <mat-step [stepControl]="postInformationGroup" label="Details">

        <form [formGroup]="postInformationGroup">

          <mat-form-field appearance="outline">
            <mat-label>Volunteer Opportunity Title (Max. 50 Characters)</mat-label>
            <input matInput class="form-input" type="text" name="title" [formControl]="titleControl" required
              placeholder="eg Weekend Underprivileged Teacher"
              oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
              maxlength="50" />
            <mat-error *ngIf="titleControl.errors?.invalid">Please provide us the job's title.</mat-error>
            <mat-hint>Characters Remaining: {{50 - titleControl.value.length}}</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Volunteer Opportunity Description (maximum 500 characters)</mat-label>
            <textarea matInput class="form-input" name="content" rows="10" required [formControl]="contentControl"
              placeholder="Please give a short description of the volunteer opportunity (maximum 500 characters)."></textarea>
            <mat-error *ngIf="contentControl.errors?.invalid">Please give us a description of the job (maximum 500
              characters).</mat-error>
            <mat-hint> Characters Remaining: {{500 - contentControl.value.length}} </mat-hint>
          </mat-form-field>

          <!-- <mat-form-field appearance="outline">
            <mat-label>Preferred Skills</mat-label>
            <mat-select
              required
              multiple
              [formControl]="skillsControl"
              name="skillsSelected"
            >
              <mat-option
                *ngFor="let skill of skills"
                [value]="skill"
                >{{ skill }}</mat-option
              >
            </mat-select>
            <mat-error *ngIf="skillsControl.errors?.invalid"
              >Please select the skill(s) an applicant require for the job.</mat-error
            >
          </mat-form-field> -->

          <div class="skills-label-container">
            <mat-label>Preferred Skills</mat-label>
          </div>

          <mat-selection-list required [formControl]="skillsControl">
            <mat-list-option *ngFor="let skill of skills" [value]="skill">
              {{skill}}
            </mat-list-option>
          </mat-selection-list>
          <mat-error *ngIf="skillsControl.errors?.invalid"
              >Please select the skill(s) that an applicant require for the job.</mat-error
          >


          <mat-form-field appearance="outline">
            <mat-label>Beneficiaries</mat-label>
            <mat-select required [formControl]="beneficiariesControl" name="beneficiariesSelected">
              <mat-option *ngFor="let beneficiary of beneficiaries" [value]="beneficiary">{{ beneficiary }}</mat-option>
            </mat-select>
            <mat-error *ngIf="beneficiariesControl.errors?.invalid">Please provide us the main beneficiaries of this
              opportunity.</mat-error>
          </mat-form-field>

          <div>
            <button *ngIf="!imagePreview" mat-stroked-button type="button" (click)="filePicker.click()"
              class="image-upload-button">Upload an image <i>(Optional)</i></button>
            <button *ngIf="imagePreview" mat-stroked-button type="button" (click)="removeImage()"
              class="image-upload-button">Remove Image</button>
            <input type="file" #filePicker (change)="onImagePicked($event)">
          </div>

          <div class="image-preview"
            *ngIf="imagePreview !== '' && imagePreview && postInformationGroup.get('image').valid">
            <img [src]="imagePreview" [alt]="postInformationGroup.value.titleControl">
          </div>
        </form>

        <div class="step-footer">
          <button mat-raised-button color="accent" matStepperPrevious class="nav-button">Back</button>
          <button mat-raised-button color="primary" matStepperNext class="nav-button">Next</button>
        </div>

      </mat-step>

      <mat-step [stepControl]="postDurationGroup" label="Duration">
        <form [formGroup]="postDurationGroup">

          <!--
          <div class="post-create-opportunity">
            <mat-radio-group required [formControl]="opportunitySelectedControl">
              <mat-radio-button value="Ad-hoc / One-off">
                Ad-hoc / One-off
              </mat-radio-button>

              <mat-radio-button value="Regular / Recurring"
                >Regular / Recurring</mat-radio-button
              >
            </mat-radio-group>
          </div>
          -->

          <mat-form-field appearance="outline">
            <mat-label>Volunteer Type</mat-label>
            <mat-select required [formControl]="opportunitySelectedControl" name="opportunitySelected">
              <mat-option *ngFor="let opportunity of opportunities" [value]="opportunity">{{ opportunity }}</mat-option>
            </mat-select>
            <mat-error *ngIf="opportunitySelectedControl.errors?.invalid">Please indicate the frequency of this job.
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Choose a start date</mat-label>
            <input matInput class="form-input" [matDatepicker]="startDatePicker" placeholder="MM/DD/YYYY"
              [formControl]="startDateControl" name="startDate" required>
            <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #startDatePicker></mat-datepicker>
            <mat-error *ngIf="startDateControl.errors?.invalid">
              Please pick a start date.
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Choose an end date</mat-label>
            <input matInput class="form-input" [matDatepicker]="endDatePicker" placeholder="MM/DD/YYYY"
              [formControl]="endDateControl" name="endDate" required>
            <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #endDatePicker></mat-datepicker>
            <mat-error *ngIf="endDateControl.errors?.invalid">
              Please pick an end date.
            </mat-error>
          </mat-form-field>

          <mat-error
            *ngIf="(startDateControl.value && endDateControl.value) && (startDateControl.value > endDateControl.value)">
            You cannot proceed if the start date is be later than the end date!
          </mat-error>

          <mat-form-field appearance="outline">
            <mat-label>Commitment Information</mat-label>
            <input matInput class="form-input" type="text" name="hoursRequired" required
              [formControl]="hoursRequiredControl"
              placeholder="eg 1hr per week, Monday to Friday, anytime between 8am - 3pm" />
            <mat-error *ngIf="hoursRequiredControl.errors?.invalid">Please provide the details on the commitment
              required of the student.</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Location <i>(Optional)</i></mat-label>
            <mat-select [formControl]="locationControl" name="locationSelected">
              <mat-option *ngFor="let location of locations" [value]="location">{{ location }}</mat-option>
            </mat-select>
          </mat-form-field>



        </form>

        <div class="step-footer">
          <button mat-raised-button color="accent" matStepperPrevious class="nav-button">Back</button>


          <button mat-raised-button disabled matStepperNext class="nav-button"
            *ngIf="(startDateControl.value && endDateControl.value) && (startDateControl.value > endDateControl.value)">Next</button>

          <button mat-raised-button color="primary" matStepperNext (click)="generatePreview()" class="nav-button"
            *ngIf="! ((startDateControl.value && endDateControl.value) && (startDateControl.value > endDateControl.value))">Next</button>

        </div>
      </mat-step>

      <mat-step label="Post Preview">

        <div class="post-preview">

          <ng-container>
            <section class="cards">
              <mat-card class="published-post-card">
                <img *ngIf="!postPreview.imagePath && postPreview.beneficiaries" mat-card-image class="card-image"
                  src="../../../assets/placeholder-{{postPreview.beneficiaries}}.png" alt="Placeholder image for post" />

                <img *ngIf="postPreview.imagePath" mat-card-image class="card-image" src="{{postPreview.imagePath}}"
                  alt="Post's image" />


                <mat-card-title class="post-card-title">
                  {{ postPreview.title }}
                </mat-card-title>
                <mat-card-subtitle class="post-card-subtitle">
                  by <b>{{ postPreview.orgName }}</b>
                </mat-card-subtitle>
                <mat-card-content class="post-card-content">
                  <!-- <mat-icon>event</mat-icon> {{ postPreview.startDate | date }} to
                  {{ postPreview.endDate | date }} <br />
                  <mat-icon>schedule</mat-icon> {{ postPreview.hoursRequired }} <br />
                  <mat-icon> location_on</mat-icon> {{ postPreview.location || "Not Specified" }} <br />
                  <mat-icon>people_outline</mat-icon> Skillsets: {{ postPreview.skills }}
                  <br /> -->
                  <ul>
                    <li>
                      <mat-icon>event</mat-icon> {{postPreview.startDate | date}} to {{postPreview.endDate | date}}
                    </li>
                    <li>
                      <mat-icon>schedule</mat-icon> {{postPreview.hoursRequired}}
                    </li>
                    <li>
                      <mat-icon> location_on</mat-icon> {{postPreview.location || "Not Specified"}}
                    </li>
                    <li>
                      <mat-icon>people_outline</mat-icon> Skillsets: {{postPreview.skills}}
                    </li>
                  </ul>
                </mat-card-content>
                <mat-card-footer class="post-card-footer">
                  <button matTooltip="Click for more information" [matTooltipShowDelay]="100"
                    [matTooltipHideDelay]="100" mat-button aria-label="Learn More" color="primary"
                    class="post-card-footer-button" (click)="onMoreInfo(content)">
                    <mat-icon color="primary">help_outline</mat-icon>
                  </button>
                </mat-card-footer>
              </mat-card>
            </section>

            <ng-template #content let-modal>

              <!-- This example requires Tailwind CSS v2.0+ -->
              <div class="bg-white shadow overflow-hidden sm:rounded-lg">
                <div class="closelearnmore">
                  <button type="button" class="btn-close" aria-label="Close" (click)="modal.close('Close click')"
                  ></button>
                </div>
                <div class="px-4 py-3 sm:px-6">
                  <h3 class="text-lg leading-6 font-medium text-gray-900">
                    {{postPreview.title}}
                  </h3>

                  <p class="mt-1 max-w-2xl text-sm text-gray-500">
                    by <i>{{postPreview.orgName}}</i>
                  </p>

                </div>

                <div class="border-t border-gray-200">
                  <dl>

                    <div class="bg-gray-50 px-4 py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                      <dt class="text-sm font-medium text-gray-500">
                        About
                      </dt>
                      <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                        <p>{{postPreview.content}}</p>
                      </dd>
                    </div>

                    <div class="bg-white px-4 py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                      <dt class="text-sm font-medium text-gray-500">
                        Point-Of-Contact's Name
                      </dt>
                      <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                        {{postPreview.POC}}
                      </dd>
                    </div>

                    <div class="bg-gray-50 px-4 py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                      <dt class="text-sm font-medium text-gray-500">
                        Contact Number
                      </dt>
                      <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                        {{postPreview.phoneNumber}}
                      </dd>
                    </div>

                    <div class="bg-white-50 px-4 py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                      <dt class="text-sm font-medium text-gray-500">
                        Email Address
                      </dt>
                      <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                        {{postPreview.email}}
                      </dd>
                    </div>

                    <div class="bg-gray-50 px-4 py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                      <dt class="text-sm font-medium text-gray-500">
                        Preferred Skillset
                      </dt>
                      <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                        {{postPreview.skills}}
                      </dd>
                    </div>

                    <div class="bg-white-50 px-4 py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                      <dt class="text-sm font-medium text-gray-500">
                        Beneficiaries
                      </dt>
                      <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                        {{postPreview.beneficiaries}}
                      </dd>
                    </div>

                    <div class="bg-gray-50 px-4 py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                      <dt class="text-sm font-medium text-gray-500">
                        Duration
                      </dt>
                      <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                        {{postPreview.startDate | date}} to {{postPreview.endDate | date}}
                      </dd>
                    </div>

                    <div class="bg-white-50 px-4 py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                      <dt class="text-sm font-medium text-gray-500">
                        Commitment Information
                      </dt>
                      <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                        {{postPreview.hoursRequired}}
                      </dd>
                    </div>

                    <div class="bg-gray-50 px-4 py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                      <dt class="text-sm font-medium text-gray-500">
                        Location
                      </dt>
                      <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                        {{postPreview.location || "Not Specified"}}
                      </dd>
                    </div>

                  </dl>
                </div>
              </div>

            </ng-template>

          </ng-container>

        </div>

        <div class="step-footer">
          <button mat-raised-button color="accent" matStepperPrevious class="nav-button">Back</button>
          <button mat-raised-button color="warn" (click)="stepper.reset()" class="nav-button">Reset</button>
          <button mat-raised-button color="primary" matStepperNext class="nav-button">Next</button>
        </div>
      </mat-step>


      <mat-step label="Terms and Conditions">

        <div class="toc-header">
          <h4>Terms and Conditions</h4>
        </div>
        <div class="toc-body">
          <p>Terms and Conditions of Use</p>

          <br />
          <p>1. Agreement to Terms</p>
          <p>
            All access of any area of <a href="http://ccsgp-portal.s3-website-ap-southeast-1.amazonaws.com/"
              target="_blank">CCSGP Jobs Portal</a> ("The Website") is
            governed by the terms and conditions below ("Terms"). If you do not accept
            any of these Terms, exit immediately. Continue only if you accept these
            Terms. In these Terms, the words "we", "our" and "us" refers to the
            Government of Singapore.
          </p>

          <br />
          <p>2. Access To The Website</p>
          <p>
            The accessibility and operation of The Website relies on technologies
            outside our control. We do not guarantee continuous accessibility or
            uninterrupted operation of The Website.
          </p>

          <br />
          <p>3. Relying On Information</p>
          <p>
            We provide The Website as a general information source only and we are not
            involved in giving professional advice here. The Website may not cover all
            information available on a particular issue. Before relying on the
            Website, you should do your own checks or obtain professional advice
            relevant to your particular circumstances.
          </p>

          <br />
          <p>4. Security</p>
          <p>
            Where appropriate, we use available technology to protect the security of
            communications made through The Website. However, we do not accept
            liability for the security, authenticity, integrity or confidentiality of
            any transactions and other communications made through The Website.
          </p>
          <br />
          <p>
            Internet communications may be susceptible to interference or interception
            by third parties. Despite our best efforts, we make no warranties that The
            Website is free of infection by computer viruses or other unauthorised
            software.
          </p>

          <br />
          <p>5. Hyperlinks</p>
          <p>
            We are not responsible or liable for the availability or content of any
            other Internet site (not provided by us) linked to or from The Website.
            Access to any other Internet site is at your own risk. If you create a
            link or frame to The Website, you do so at your own risk.
          </p>
          <br />
          <p>
            We reserve the right to object or disable any link or frame to or from The
            Website.
          </p>
          <br />
          <p>We reserve the right to change the URL of The Website.</p>

          <br />
          <p>6. Intellectual Property</p>
          <p>
            Materials, including source code, pages, documents and online graphics,
            audio and video in The Website are protected by law. The intellectual
            property rights in the materials is owned by or licensed to us. All rights
            reserved. (Government of Singapore © 2018).
          </p>
          <br />
          <p>
            Apart from any fair dealings for the purposes of private study, research,
            criticism or review, as permitted in law, no part of The Website may be
            reproduced or reused for any commercial purposes whatsoever without our
            prior written permission.
          </p>

          <br />
          <p>7. General Disclaimer And Limitation Of Liability</p>
          <p>We will not be liable for any loss or damage</p>
          <br />
          <p>
            1. That you may incur on account of using, visiting or relying on any
            statements, opinion, representation or information in The Website;
          </p>
          <p>
            2. Resulting from any delay in operation or transmission, communications
            failure, Internet access difficulties or malfunctions in equipment or
            software; or
          </p>
          <p>
            3. Resulting from the conduct or the views of any person who accesses or
            uses The Website.
          </p>

          <br />
          <p>8. Fees</p>
          <p>
            There are currently no fees for using any part of The Website. We reserve
            the right to introduce new fees from time to time. We are not responsible
            for any fees charged by any other Internet site (not provided by us).
          </p>

          <br />
          <p>9. Applicable Laws</p>
          <p>
            Use of The Website and these Terms are governed by the laws of Singapore.
            Any claim relating to use of The Website shall be heard by Singapore
            Courts.
          </p>

          <br />
          <p>10. Variation</p>
          <p>
            We may revise these Terms at any time by updating this page. You should
            visit this page from time to time and review the then current Terms
            because they are binding on you. We may modify or discontinue any
            information or features that form part of The Website at any time, with or
            without notice to you, and without liability.
          </p>
        </div>

        <div class="toc-footer">

          <mat-checkbox ngModel name="checkbox" #checkbox="ngModel" required>
            I have read the above Terms and Conditions.
          </mat-checkbox>
          <mat-error *ngIf="checkbox.invalid">
            Please click on the checkbox at the end of the page.
          </mat-error>
        </div>

        <div class="step-footer">
          <button mat-raised-button color="accent" matStepperPrevious class="nav-button">Back</button>
          <button mat-raised-button color="primary" (click)="checkbox.valid && onAddPostReactive() && openDialog()"
            class="nav-button">Submit</button>
        </div>
      </mat-step>

    </mat-horizontal-stepper>
  </mat-card>
</div>

<!--
<footer class="container">
  <p class="copyright">&copy; Orbital 2021 Team StudyGoWhere, ID 2601, Darren Hoon and Wilbur Fong. <br>
    In conjuction with the Centre for Computing for Social Good and Philanthropy (CCSGP), NUS.
  </p>
</footer>
-->
